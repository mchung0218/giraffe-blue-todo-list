!function t(o,e,r){function n(s,a){if(!e[s]){if(!o[s]){var c="function"==typeof require&&require;if(!a&&c)return c(s,!0);if(i)return i(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var d=e[s]={exports:{}};o[s][0].call(d.exports,function(t){var e=o[s][1][t];return n(e?e:t)},d,d.exports,t,o,e,r)}return e[s].exports}for(var i="function"==typeof require&&require,s=0;s<r.length;s++)n(r[s]);return n}({1:[function(t,o,e){"use strict";function r(t,o){t.defaults.xsrfCookieName="csrftoken",t.defaults.xsrfHeaderName="X-CSRFToken",o.defaults.stripTrailingSlashes=!1}o.exports=r},{}],2:[function(t,o,e){"use strict";var r=t("./app.config"),n=t("./app.routes"),i=t("./login/login.component"),s=t("./login/user/user.factory"),a=t("./login/user/user.api.factory"),c=t("./todo/todo.component"),u=t("./todo/todo.factory"),d=t("./todo/todo.refreshPage.directive"),l=t("./todo/form/todo-form.component"),f=t("./todo/list/todo-list.component"),p=t("./todo/list/todo-list.factory"),m=t("./todo/list/todo-list.filter"),g=t("./todo/list/task/todo-task.component"),k=t("./todo/list/task/todo-task.api.factory"),h=t("./todo/list/task/todo-task.enterEditMode.directive"),v=t("./todo/list/task/todo-task.exitEditMode.directive"),y=t("./todo/list/task/todo-task.toggleOptions.directive"),T=t("./todo/footer/todo-footer.component"),C=t("./todo/footer/counter/todo-counter.component"),x=t("./todo/footer/filter/todo-filter.component"),F=t("./todo/footer/filter/todo-filter.factory"),P=angular.module("todo",["ui.router","ngResource"]);P.config(["$httpProvider","$resourceProvider",r]).config(["$stateProvider","$urlRouterProvider",n]),P.filter("priority",m),P.factory("userFact",["userApi",s]).factory("userApi",["$resource",a]).factory("todoFact",["taskApi",u]).factory("listFact",p).factory("taskApi",["$resource",k]).factory("filterFact",F),P.component("login",i).component("todo",c).component("todoForm",l).component("todoList",f).component("todoTask",g).component("todoFooter",T).component("todoCounter",C).component("todoFilter",x),P.directive("refreshPage",["userFact","$window",d]).directive("taskEnterEditMode",h).directive("taskExitEditMode",v).directive("toggleOptionsMenu",y)},{"./app.config":1,"./app.routes":3,"./login/login.component":4,"./login/user/user.api.factory":5,"./login/user/user.factory":6,"./todo/footer/counter/todo-counter.component":7,"./todo/footer/filter/todo-filter.component":8,"./todo/footer/filter/todo-filter.factory":9,"./todo/footer/todo-footer.component":10,"./todo/form/todo-form.component":11,"./todo/list/task/todo-task.api.factory":12,"./todo/list/task/todo-task.component":13,"./todo/list/task/todo-task.enterEditMode.directive":14,"./todo/list/task/todo-task.exitEditMode.directive":15,"./todo/list/task/todo-task.toggleOptions.directive":16,"./todo/list/todo-list.component":17,"./todo/list/todo-list.factory":18,"./todo/list/todo-list.filter":19,"./todo/todo.component":20,"./todo/todo.factory":21,"./todo/todo.refreshPage.directive":22}],3:[function(t,o,e){"use strict";function r(t,o){o.otherwise("/"),t.state("login",{url:"/",template:"<login></login>",resolve:{checkLoggedIn:["$q","$state","userFact",function(t,o,e){var r=t.defer();return e.checkLoggedIn().then(function(t){e.update({username:t.username}),"true"===t.login?(r.resolve(),o.go("todo")):r.resolve()},function(t){r.resolve()}),r.promise}]}}).state("todo",{template:"<todo></todo>"})}o.exports=r},{}],4:[function(t,o,e){"use strict";function r(t,o){var e=this;e.error={badRegisterEmail:!1,badMissingFields:!1,badLogin:!1,changePassNoUserFound:!1,changePassFail:!1},e.resetErrors=function(){for(var t in e.error)e.error[t]=!1},e.registerUser=function(){if(e.resetErrors(),e.form.password&&e.form.email){var o={email:e.form.email,password:e.form.password};t.register(o).then(function(t){e.loginUser(o)},function(t){e.error.badRegisterEmail=!0,e.clearPassFields()})}else e.error.badMissingFields=!0},e.loginUser=function(){e.resetErrors();var r={email:e.form.email,password:e.form.password};t.login(r).then(function(n){t.update({username:r.email}),"true"===n.login?o.go("todo"):(e.error.badLogin=!0,e.clearPassFields())},function(t){e.error.badLogin=!0,e.clearPassFields()})},e.changePass=function(){if(e.resetErrors(),e.form.new_password&&e.form.email){var o={email:e.form.email,new_password:e.form.new_password};t.changePass(o).then(function(t){"true"===t.error?("User not found"===t.errorMessage?e.error.changePassNoUserFound=!0:e.error.changePassFail=!0,e.clearPassFields()):e.forgotMode=!1},function(t){e.error.changePassFail=!0,e.clearPassFields()})}else e.error.badMissingFields=!0},e.clearPassFields=function(){e.form.password="",e.form.new_password=""}}o.exports={controller:["userFact","$state",r],templateUrl:"/static/app/login/login.html"}},{}],5:[function(t,o,e){"use strict";function r(t){return{User:t("/user/"),UserLoggedIn:t("/user/loggedin",{},{check:{method:"POST"}}),UserCreate:t("/user/create",{}),UserLogin:t("/user/auth",{},{login:{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:function(t){var o=[];for(var e in t)o.push(encodeURIComponent(e)+"="+encodeURIComponent(t[e]));return o.join("&")}}}),UserLogout:t("/user/logout",{},{logout:{method:"POST"}}),UserChangePass:t("/user/changepass",{},{save:{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:function(t){var o=[];for(var e in t)o.push(encodeURIComponent(e)+"="+encodeURIComponent(t[e]));return o.join("&")}}})}}o.exports=r},{}],6:[function(t,o,e){"use strict";function r(t){var o={username:""};return o.register=function(o){return t.UserCreate.save(o).$promise},o.login=function(o){return t.UserLogin.login(o).$promise},o.logout=function(){return t.UserLogout.logout().$promise},o.changePass=function(o){return t.UserChangePass.save(o).$promise},o.checkLoggedIn=function(){return t.UserLoggedIn.check().$promise},o.update=function(t){for(var e in t)o[e]=t[e]},o}o.exports=r},{}],7:[function(t,o,e){"use strict";function r(t,o){var e=this;e.activeTaskCount=function(){var e=o.option,r=[];return"completed"!==e&&(r=t.taskList.filter(function(t){return"all"===e||"active"===e?!t.completed:t.priority===e})),r.length}}o.exports={controller:["listFact","filterFact",r],templateUrl:"/static/app/todo/footer/counter/todo-counter.html"}},{}],8:[function(t,o,e){"use strict";function r(t){var o=this;o.menuOpen=!1,o.currentFilter=t.getCurrentOption,o.changeFilter=function(o){t.changeOption(o)},o.toggleFilterMenu=function(){o.menuOpen=!o.menuOpen},o.changeFilter("all")}o.exports={controller:["filterFact",r],templateUrl:"/static/app/todo/footer/filter/todo-filter.html"}},{}],9:[function(t,o,e){"use strict";function r(){var t={option:"all"};return t.getCurrentOption=function(o){return t.option},t.changeOption=function(o){t.option=o},t}o.exports=r},{}],10:[function(t,o,e){"use strict";function r(t){var o=this;o.show=function(){return t.taskList.length>0}}o.exports={controller:["listFact",r],templateUrl:"/static/app/todo/footer/todo-footer.html"}},{}],11:[function(t,o,e){"use strict";function r(t,o){var e=this;e.submit=function(){var r={text:e.form.taskName,priority:"low"};t.addTask(r).then(function(t){var e=t.task;o.addTask(e)},function(t){alert("Failed to add task.")})}}o.exports={controller:["todoFact","listFact",r],templateUrl:"/static/app/todo/form/todo-form.html"}},{}],12:[function(t,o,e){"use strict";function r(t){return{Tasks:t("/tasks/"),Task:t("/task/:id",{id:"@id"},{save:{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:function(t){var o=[];for(var e in t)o.push(encodeURIComponent(e)+"="+encodeURIComponent(t[e]));return o.join("&")}},update:{method:"PATCH"}}),TaskCompleted:t("/task/completed/:id",{id:"@id"},{update:{method:"PATCH"}}),TaskPriority:t("/task/priority/:id",{id:"@id"},{update:{method:"PATCH"}})}}o.exports=r},{}],13:[function(t,o,e){"use strict";function r(t,o){var e=this;e.optionsMenuOpen=!1,e.error={permissionEdit:!1,failEdit:!1,permissionDelete:!1,failDelete:!1,changePriority:!1,markCompleted:!1},e.resetErrors=function(){for(var t in e.error)e.error[t]=!1},e.toggleOptionsMenu=function(){e.optionsMenuOpen=!e.optionsMenuOpen},e.deleteTask=function(r){e.resetErrors(),t.deleteTask(r).then(function(t){"true"===t.error?"Permission Denied"===t.errorMessage?e.error.permissionDelete=!0:e.error.failDelete=!0:o.deleteTask(r)},function(t){e.error.failDelete=!0})},e.editTask=function(r,n){n.length>0&&n!==e.prevName?(e.resetErrors(),t.editTask(r,n).then(function(t){"true"===t.error?(e.task.text=e.prevName,"Permission Denied"===t.errorMessage?e.error.permissionEdit=!0:e.error.failEdit=!0):o.editTask(r,n)},function(t){e.task.text=e.prevName,e.error.failEdit=!0})):e.task.text=e.prevName},e.changePriority=function(r,n){e.resetErrors(),t.changePriority(r,n).then(function(t){"true"===t.error?e.error.changingPriority=!0:(o.changePriority(r,n),"completed"===n&&e.markCompleted(r))},function(t){e.error.changingPriority=!0})},e.markCompleted=function(r){e.resetErrors(),t.markCompleted(r).then(function(t){"true"===t.error?e.error.markCompleted=!0:o.markCompleted(r)},function(t){e.error.markCompleted=!0})}}o.exports={controller:["todoFact","listFact",r],templateUrl:"/static/app/todo/list/task/todo-task.html",bindings:{task:"="}}},{}],14:[function(t,o,e){function r(){return{restrict:"A",link:function(t,o){var e=o.parent()[0].getElementsByClassName("todo-list__task-name--input")[0];o.on("click",function(){o.addClass("hide"),angular.element(e).removeClass("hide"),e.focus()})}}}o.exports=r},{}],15:[function(t,o,e){function r(){return{restrict:"A",link:function(t,o){var e=o.parent()[0].getElementsByClassName("todo-list__task-name--span")[0],r=function(){o.addClass("hide"),angular.element(e).removeClass("hide")};o.on("blur",r),o.on("keypress",function(t){t.keyCode||t.which;13===t.keyCode&&r()})}}}o.exports=r},{}],16:[function(t,o,e){"use strict";function r(){return{restrict:"A",link:function(t,o){o.on("click",function(){if(o.hasClass("todo-list__task-btn-option--open"))o.removeClass("todo-list__task-btn-option--open");else{var t=document.getElementsByClassName("todo-list__task-btn-option--open");Array.prototype.forEach.call(t,function(t){angular.element(t).removeClass("todo-list__task-btn-option--open")}),o.addClass("todo-list__task-btn-option--open")}})}}}o.exports=r},{}],17:[function(t,o,e){"use strict";function r(t,o,e){var r=this;r.taskList=o.taskList,r.getTaskList=function(){t.getTaskList().then(function(t){o.copyServerList(t.tasks),r.taskList=o.taskList})},r.listFilter=function(){return e.option},r.getTaskList()}o.exports={controller:["todoFact","listFact","filterFact",r],templateUrl:"/static/app/todo/list/todo-list.html"}},{}],18:[function(t,o,e){"use strict";function r(){var t={};return t.taskList=[],t.copyServerList=function(o){t.taskList=o},t.getTask=function(o){for(var e=0;e<t.taskList.length;e++)if(t.taskList[e].id===o)return{object:t.taskList[e],index:e}},t.addTask=function(o){t.taskList.push(o)},t.deleteTask=function(o){var e=t.getTask(o);t.taskList.splice(e.index,1)},t.editTask=function(o,e){var r=t.getTask(o);t.taskList[r.index].text=e},t.changePriority=function(o,e){var r=t.getTask(o);t.taskList[r.index].priority=e,1===r.object.completed&&(t.taskList[r.index].completed=0)},t.markCompleted=function(o){var e=t.getTask(o);t.taskList[e.index].completed=1},t}o.exports=r},{}],19:[function(t,o,e){"use strict";function r(){function t(t){return this.filter(function(o){return o.priority===t})}function o(){return this.filter(function(t){return"completed"!==t.priority})}return function(e,r){return"all"===r?e:"active"===r?o.call(e):t.call(e,r)}}o.exports=r},{}],20:[function(t,o,e){"use strict";function r(t,o){var e=this;e.username=t.username,e.logoutUser=function(){t.logout().then(function(t){o.go("login")},function(t){alert("Failed to log out for some reason.")})}}o.exports={controller:["userFact","$state",r],templateUrl:"/static/app/todo/todo.html"}},{}],21:[function(t,o,e){"use strict";function r(t){var o={};return o.getTaskList=function(){return t.Tasks.get().$promise},o.addTask=function(o){return o.id=0,t.Task.save(o).$promise},o.deleteTask=function(o){return t.Task["delete"]({id:o}).$promise},o.editTask=function(o,e){return t.Task.update({id:o,text:e}).$promise},o.changePriority=function(o,e){return t.TaskPriority.update({id:o,priority:e}).$promise},o.markCompleted=function(o){return t.TaskCompleted.update({id:o}).$promise},o}o.exports=r},{}],22:[function(t,o,e){"use strict";function r(t,o){return{restrict:"A",link:function(e,r){r.on("click",function(){t.checkLoggedIn().then(function(e){t.username!==e.username&&o.location.reload()})})}}}o.exports=r},{}]},{},[2]);